# Практическая работа по курсу slurm.io

## Принятые ограничения, допущения и прочие коммментарии

1. Разрабатываемые в настоящей работе playbooks расчитаны на исполнение в операционной системе CentOS 7
2. Шифрование строк, применяемое в работе несет учебный характер, данные не являются чувстивтельными
3. Создаваемая Vagrant машина имеет фиксированный IP адрес 192.168.50.5
4. Основные перменные в group_vars
5. Инвентори в формате yaml, потому что было интересно попрактиковать.
6. При создании машины используется провайдер libvirt
7. SELinux переводится в permessive mode. При наличии времени, можно было бы вкатить модуль для SELinux. Заготовка в tasks/nginx_socket_write.yml
8. Конфиг nginx.conf перебивается целиком, лишнии конфиги удаляются. Предполагается, что приложение является единственным в среде. 
9. Конфиг nginx накатывается через template c контрольной машины, не используется lineinfile. Потому, что
   1. если не править файл на месте дистрибутива, то придется его копировать и делать lineinfile 
   2. следовательно, следующий прогон будет вызывать changed, потому что после lineinfile файл уже поменяется, копированием опять поменяется и т.д
10. Роль slurmdb явлется оберткой вокруг geerlingguy.postgresql, поскольку из-за некорректной и неполной постановки задачи временные затраты на запуск xpaste превысили разумные нормы. Да и зачем, если уже все написано до нас.
11. Умышленно оставлены play на каждый существенный шаг, чтобы можно было дергать их отдельно. Да, это приводит к gather facts лишним, но мне так удобно для решения текущей задачи.
12. Последний play делает assert на содержимое по порту 80

## Порядок действий

1. Создание машины
   
``` vagrant up```

2. Накатка playbook 
   ```ansible-playbook ./deploy_xpaste.yml --ask-vault-pass```

